<!--pages/index/index.wxml-->
<view wx:if="{{ shop_setting }}">
  <view class="van-hairline--bottom">
    <view wx:if="{{ userInfo }}" class="home-user_info">
      <navigator class="home-user_info__name" url="/pages/user/index" hover-class="none">
        <image class="home-user_info__avatar" mode="aspectFit" src="{{ userInfo.avatarUrl }}" />
        <text>{{ userInfo.nickName }}</text>
      </navigator>
      <text class="home-user_info__btn" bind:tap="logout">退出</text>
    </view>
    <view wx:else class="home-user_login" bind:tap="login">
      <van-icon name="user-circle-o" size="18px" color="#07c160" />
      <text class="home-user_login__btn">未登录</text>
    </view>
  </view>
  <swiper indicator-dots autoplay circular class="home-swiper">
    <block wx:for="{{banner}}" wx:key="img">
      <swiper-item>
        <navigator url="/pages/product/index?id={{ item.id }}" hover-class="none" wx:if="{{ item.id }}">
          <image class="home-swiper_item" mode="aspectFill" src="{{ item.img }}" />
        </navigator>
        <image class="home-swiper_item" mode="aspectFill" src="{{ item.img }}" wx:else />
      </swiper-item>
    </block>
  </swiper>
  <shop-discount discountList="{{ discountList }}" />
  <van-tabs active="{{ active }}" bind:change="handleTabChange" wx:if="{{ shop_setting.showComment }}">
    <van-tab title="商品" />
    <van-tab title="评价" />
  </van-tabs>
  <view wx:if="{{ categoryLoading }}" class="home-product_loading">
    <van-loading size="36px" vertical vertical color="#ee0a24">
      <text style="color: #ee0a24;">
        加载中...
      </text>
    </van-loading>
  </view>
  <view class="home-product" wx:else>
    <scroll-view scroll-y class="home-product_category">
      <van-sidebar active-key="{{ activeCategoryIndex }}">
        <van-sidebar-item wx:for="{{ category }}" title="{{ item.name }}" wx:key="_id" />
      </van-sidebar>
    </scroll-view>
    <scroll-view scroll-y class="home-product_list">
      <van-card lazy-load price="2.00" origin-price="10.00" tag="热销" desc="描述信息" title="商品标题" thumb="https://img01.yzcdn.cn/vant/ipad.jpeg">
        <view slot="num" style="float: right;" wx:if="{{ !shop_setting.close }}">
          <van-icon name="cart-o" />
        </view>
      </van-card>
    </scroll-view>
  </view>
</view>
<shop-initial wx:else shop-initial-fail="{{ shop_initial_fail }}" />
<shop-register wx:if="{{ register }}" bind:register="handleRegister" bind:close="handleCloseRegister" />
<shop-popup-discount id="popup-discount" />
<van-toast id="van-toast" />